/**
* Infinity Scroll
* @author Carlos Vinicius [Quatro Digital]
* @version 3.7
* @License MIT
* @contributor https://github.com/freires (https://github.com/caljp13/VTEX-Infinity-Scroll/pull/2)
*/
"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
(function(e){"function"!==typeof e.fn.QD_infinityScroll&&(window._QuatroDigital_InfinityScroll=window._QuatroDigital_InfinityScroll||{},e.fn.QD_infinityScroll=function(s){var g,f,d,c,h,r,m,b,l;b=window._QuatroDigital_InfinityScroll;f=function(a,b){if("object"===typeof console){var c="object"===typeof a;"undefined"===typeof b||"alerta"!==b.toLowerCase()&&"aviso"!==b.toLowerCase()?"undefined"!==typeof b&&"info"===b.toLowerCase()?c?console.info("[Infinity Scroll]\n",a[0],a[1],a[2],a[3],a[4],a[5],a[6],
a[7]):console.info("[Infinity Scroll]\n"+a):c?console.error("[Infinity Scroll]\n",a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]):console.error("[Infinity Scroll]\n"+a):c?console.warn("[Infinity Scroll]\n",a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]):console.warn("[Infinity Scroll]\n"+a)}};g={lastShelf:">div:last",elemLoading:'<div id="scrollLoading">Carregando ... </div>',searchUrl:null,returnToTop:e('<div id="returnToTop"><a href="#"><span class="text">voltar ao</span><span class="text2">TOPO</span><span class="arrowToTop"></span></a></div>'),
scrollBy:document,callback:function(){},getShelfHeight:function(){return c.scrollTop()+c.height()},paginate:null,insertContent:function(a,b){a.after(b)},authorizeScroll:function(){return!0}};d=jQuery.extend({},g,s);c=jQuery(this);jQuery("");if(1>c.length)return c;1<c.length&&(f("Identifiquei que a seletor informado ("+c.selector+") retornou "+c.length+" elementos.\n Para solucionar o problema estou selecionando autom\u00e1ticamente o primeiro com o id: #"+(c.filter("[id^=ResultItems]:first").attr("id")||
"!Not Found"),"Aviso"),c=c.filter("[id^=ResultItems]:first"));c.filter("[id^=ResultItems]").length||f(["Certifique-se que esta selecionando o elemento correto.\n O plugin espera que o elemento seja o que cont\u00e9m o id: #"+(e("div[id^=ResultItems]").attr("id")||"!Not Found"),e("div[id^=ResultItems]")],"Info");c.parent().filter("[id^=ResultItems]").length&&(c=c.parent(),f(["Identifiquei que o seletor pai do elemento que voc\u00ea informou \u00e9 o #"+(jQuery("div[id^=ResultItems]").attr("id")||"!Not Found")+
".\n Como forma de corrigir esse problema de sele\u00e7\u00e3o de elemento, assumirei a prateleira correta.",c],"Aviso"));e("body").append(d.returnToTop);h=e(window);r=e(document);l=e(d.scrollBy);b.toTopE=e(d.returnToTop);m=e(d.elemLoading);b.moreResults=!0;b.currentPage=2;var q={scrollToTop:function(){var a,c,d;a=h.height();l.bind("resize.QD_infinityScroll",function(){a=h.height()});c=null;d=function(){r.scrollTop()>a?b.toTopE.stop(!0).fadeTo(300,1,function(){b.toTopE.show()}):b.toTopE.stop(!0).fadeTo(300,
0,function(){b.toTopE.hide()})};l.bind("scroll.QD_infinityScroll",function(){c&&(clearTimeout(c),c=null);c=setTimeout(d,50)});b.buttonToTop=b.toTopE.find("a").bind("click.QD_infinityScroll",function(){jQuery("html,body").animate({scrollTop:0},"slow");return!1})},getSearchUrl:function(){var a,b,c,d;jQuery("script:not([src])").each(function(){b=jQuery(this)[0].innerHTML;c=/\/buscapagina\?.+&PageNumber=/i;d=/\/paginaprateleira\?.+PageNumber=/i;if(-1<b.indexOf("buscapagina"))return a=c.exec(b),!1;if(-1<
b.indexOf("paginaprateleira"))return a=d.exec(b),!1});if("undefined"!==typeof a&&"undefined"!==typeof a[0])return a[0].replace("paginaprateleira","buscapagina");f("N\u00e3o foi poss\u00edvel localizar a url de busca da p\u00e1gina.\n Tente adicionar o .js ao final da p\u00e1gina. \n[M\u00e9todo: getSearchUrl]");return""},infinityScroll:function(){var a,n,p,k,g;b.searchUrl=null!==d.searchUrl?d.searchUrl:q.getSearchUrl();b.currentStatus=!0;a=e(".pager[id*=PagerTop]:first").attr("id")||"";if(""!==a&&
(b.pages=window["pagecount_"+a.split("_").pop()],"undefined"===typeof b.pages))for(p in window)if(/pagecount_[0-9]+/.test(p)){b.pages=window[p];break}"undefined"===typeof b.pages&&(b.pages=9999999999999);n=function(){if(b.currentStatus){var a=c.find(d.lastShelf);if(1>a.length)return f("\u00daltima Prateleira/Vitrine n\u00e3o encontrada \n ("+a.selector+")"),!1;a.after(m);b.currentStatus=!1;var g=b.currentPage;e.ajax({url:b.searchUrl.replace(/pagenumber\=[0-9]*/i,"PageNumber="+b.currentPage),dataType:"html",
success:function(c){1>c.trim().length?(b.moreResults=!1,f("N\u00e3o existem mais resultados a partir da p\u00e1gina: "+g,"Aviso")):d.insertContent(a,c);b.currentStatus=!0;m.remove()},error:function(){f("Houve um erro na requisi\u00e7\u00e3o Ajax de uma nova p\u00e1gina.")},complete:function(a,b){d.callback()}});b.currentPage++}};"function"===typeof d.paginate?d.paginate(function(){b.currentPage<=b.pages&&b.moreResults&&n()}):(k=null,g=function(){b.currentPage<=b.pages&&b.moreResults&&h.scrollTop()+
h.height()>=d.getShelfHeight()&&d.authorizeScroll()&&n()},l.bind("scroll.QD_infinityScroll_paginate",function(){k&&(clearTimeout(k),k=null);k=setTimeout(g,50)}))}};q.scrollToTop();q.infinityScroll();return c})})(jQuery);